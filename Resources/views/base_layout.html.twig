{% extends 'MsiCmfBundle:Page:layout.html.twig' %}

{% block css %}
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css">
{#<link rel="stylesheet" href="{{ asset('bundles/msicmf/vendor/chosen/chosen.css') }}">#}
<link rel="stylesheet" href="{{ asset('bundles/msicmf/vendor/eternicode-bootstrap-datepicker/css/datepicker.css') }}">
<link rel="stylesheet" href="{{ asset('bundles/msicmf/css/admin.css') }}">
{{ parent() }}
{% endblock %}

{% block js %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
{#<script src="{{ asset('bundles/msicmf/vendor/chosen/chosen.jquery.min.js') }}"></script>#}
<script src="{{ asset('bundles/msicmf/vendor/eternicode-bootstrap-datepicker/js/bootstrap-datepicker.js') }}"></script>
<script src="{{ asset('bundles/msicmf/vendor/eternicode-bootstrap-datepicker/js/locales/bootstrap-datepicker.fr.js') }}"></script>
<script src="{{ asset('bundles/msicmf/js/admin.js') }}"></script>
<script>
// $("select.chosenify").chosen({placeholder_text_single: ' ', placeholder_text_multiple: ''});
$('.datepicker').datepicker({
    format: 'dd-mm-yyyy',
    autoclose: true,
    language: '{{ app.request.locale }}'
});
</script>
{{ parent() }}
{% endblock %}

{% block body %}
<div class="navbar navbar-fixed-top navbar-inverse">
    <div class="navbar-inner">
        <div class="container-fluid" style="padding: 0 17px;">
            <a class="brand" href="{{ path('msi_cmf_dashboard') }}">{{ block('brand') }}</a>
            {% if is_granted('ROLE_ADMIN') %}
                {{ knp_menu_render('MsiCmfBundle:MenuBuilder:adminMenu', {'allow_safe_labels': true, 'depth': 3, 'currentClass': 'active'}) }}
            {% endif %}
            {% if is_granted('ROLE_ADMIN') %}
            <p class="navbar-text pull-right">Logged in as <a href="{{ path('fos_user_profile_show') }}">{{ app.user.username }}</a> | <a href="{{ path('fos_user_security_logout') }}">{{ 'Logout'|trans }}</a></p>
            {% endif %}
        </div>
    </div>
</div>

{% if is_granted('ROLE_ADMIN') %}
<div class="container-fluid" style="padding: 0 10px;">
    <div class="row-fluid">
        <div class="span12">
            {% block breadcrumb %}
                {% include 'MsiCmfBundle:Default:breadcrumb.html.twig' with {'crumbs': admin is defined ? admin.buildBreadcrumb : [] } %}
            {% endblock breadcrumb %}
        </div>
    </div>
</div>
{% endif %}

<div class="container-fluid" style="padding: 0 10px 10px;">
    {% set sidebar = block('sidebar') %}
    <div id="main"{% if sidebar %}style="background: url(/bundles/msicmf/img/sidebar.png) repeat-y #fff;"{% endif %}>

        <div id="loader" style="position: absolute;left: 50%;top: 17px;margin-top: -36px;" class="text-center hide">
            <div style="border-radius: 0px;color: #333;border: 1px solid #ddd;padding: 10px 50px;position: relative; left: -50%;background: #fff;">
                <p><img src="/bundles/msicmf/img/ajax-loader.gif" alt="0"></p>
                saving...
            </div>
        </div>

        {% if sidebar %}
        <div id="sidebar">
            {{ msi_block_render('admin_sidebar_top', page) }}
            {{ sidebar|raw }}
            {{ msi_block_render('admin_sidebar_bottom', page) }}
        </div>
        {% endif %}

        <div id="content"{% if sidebar %}style="margin-left: 220px;"{% endif %}>
            <div class="page-header">
                <div class="alert-wrap">
                    <div class="alert alert-success hide">
                        <i class="icon-ok-sign"></i> <span></span>
                    </div>
                </div>
                {% if app.session.started %}
                    {% for flashMessage in app.session.flashbag.get('success') %}
                    <div class="alert-wrap">
                        <div class="alert alert-success fade in">
                            <i class="icon-ok-sign"></i> <span>{{ flashMessage }}</span>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
                {% set title = block('title') %}
                {% if title %}
                <div class="row-fluid">
                    <div class="span6">
                        <h2>{{ title|raw }}{{ block('title_suffix') }}</h2>
                    </div>
                    <div class="span6">
                        {% if block('actions')|length > 0 %}
                            <div class="pull-right btn-toolbar">{{ block('actions') }}</div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="row-fluid">
                <div class="span12">
                    {{ msi_block_render('admin_content_top', page) }}
                    {{ block('page_content') }}
                    {{ msi_block_render('admin_content_bottom', page) }}
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
</div>
{% endblock %}
